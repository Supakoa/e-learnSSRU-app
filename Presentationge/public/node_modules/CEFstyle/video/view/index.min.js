function getId(e){var t=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,r=e.match(t);return r&&11==r[2].length?r[2]:"error"}function takeRecord(){$("#recordItem").val(JSON.stringify(videoRecord))}let inputSrc,videoId=getId(video.data),iframeMarkup="www.youtube.com/embed/"+videoId;inputSrc="file"==video.type?dataVideo:iframeMarkup,$("#showVideo").attr("src","https://"+inputSrc),"youtube"==video.type?(player=new Plyr(document.getElementById("player1")),console.log("youtube")):(player=new Plyr(document.getElementById("player2")),console.log("file")),$(document).ready(function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}})}),$("#player1").on("ready",function(){let e=j=0,t=!1,r=!1,o=new Array(player.duration);for(let e=0;e<player.duration;e++){var n=parseInt(e%60),l=parseInt(e/60);n<10&&(n="0"+n),l<10&&(l="0"+l);var c=document.createElement("div");c.className="recordSlot",c.style.width=$("#player1").width()/player.duration+"px",c.setAttribute("at_record",e),c.setAttribute("status","undefind"),c.setAttribute("data-toggle","tooltip"),c.setAttribute("data-placement","bottom"),c.setAttribute("title",l+":"+n),c.onclick=function(){console.log("currentTime: "+e),player.currentTime=e},console.log("object :"+$("#player1").width()),document.getElementById("navProgress").appendChild(c)}console.log("duration: "+player.duration);let a={content_id:content.id,user_id:userId,record:o,percent:0};issetRecord&&(console.log("have record.."),a={content_id:content.id,user_id:userId,record:JSON.parse(record.record),percent:record.percent},o=JSON.parse(record.record)),$("#text").text(JSON.stringify(a)),$("body").on("ready",function(){console.log("ready.."),o[0]=0;setInterval(function(){$.post("/record",{muuwan:JSON.stringify(a)},function(e,t,r){console.log("store .."+e)})},5e3)}),$("#player1").on("dblclick",function(){r=!0,console.log("double click..")}),$("#player1").on("click",function(){if(r)r=!1;else{console.log("fucking click.."),t=!0;var n=setInterval(function(){if(j=e,e=Math.floor(player.currentTime),player.playing){const r=Math.floor(player.currentTime);o[r]=r,a.record=o,a.percent=Math.floor(o.filter(String).length/player.duration*100),$("#text").text(JSON.stringify(a)),e!=j&&t&&(console.log("skip.."),clearInterval(n))}else console.log("stop.."),clearInterval(n);console.log(e+++" : "+j),t=!1},1e3/player.speed)}})});